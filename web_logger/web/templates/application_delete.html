{% extends "base.html" %}
{% block title %}Application delete{% endblock %}
{% block content %}

<h1>Delete application</h1>

    <p>Warning the application binary and all historic data and logs will be deleted for application {{ app.name }}.</p>
    <form enctype="multipart/form-data" id="app_del">
        <input type="submit" value="Yes, delete the application" id="submit">
    </form>

    <script type="application/javascript">
    function completeHandler(e) {
        if (e.status == "ok") {
            location.href = "{{ url_for('web.home') }}";
        } else {
            alert("Error: " + e.msg);
        }
        return false;
    }

    function errorHandler(e) {
        alert(e.msg)
    }

    $('#app_del').on('submit', function(event) {
        event.preventDefault();
        $("#progress").show();
        $.ajax({
            url: '{{ url_for("api.application_delete", app_id=app.id) }}',  // Server script to process data
            type: 'POST',
            success: completeHandler,
            error: errorHandler,
            // Form data
            data: new FormData(this),
            //Options to tell jQuery not to process data or worry about content-type.
            cache: false,
            contentType: false,
            processData: false
        });
        return false;
    });
    </script>

{% endblock %}